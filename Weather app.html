<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather app</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Orbitron&display=swap"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  </head>
  <style>
    body {
      display: block;
      text-align: center;
      margin: 0 auto;
      padding: 10px 10px 10px 10px;
      font-family: "Orbitron", sans-serif;
    }

    h2 {
      margin: 5px 5px 20px 5px;
    }

    p {
      display: block;
      margin: 0 auto;
    }
    form {
      margin: 1px 1px 20px 1px;
    }

    .date-display {
      font-size: 20px;
    }

    .description {
      color: grey;
    }
  </style>
  <body>
    <div class="container">
      <br />
      <h1>
        Weather App
      </h1>
      <br />
    </div>
    <div class="container">
      <form class="searchform" id="search-form">
        <input type="text" id="city-input" placeholder="Enter your city" />
        <input type="submit" value="Search" />
        <input type="button" value="Current" id="current-location" />
        <br />
        <hr />
        <h2 id="city"></h2>
        <h3 class="date-display"></h3>
        <br />
        <p>
          <span id="description"></span>
          <span id="description-icon">⛅</span>
        </p>
        <br />
        <div class="row">
          <div class="col-sm">
            Temperature
          </div>
          <div class="col-sm">
            Humidity
          </div>
          <div class="col-sm">
            Wind
          </div>
        </div>
        <div class="row">
          <div class="col-sm"><span id="temperature"></span>°C</div>
          <div class="col-sm"><span id="humidity">0</span>%</div>
          <div class="col-sm"><span id="wind">10</span>km/h</div>
        </div>
      </form>

      <br />
      <hr />
      <h4><span class="badge badge-secondary">Weekdays</span></h4>
      <br />
      <div class="container-group">
        <div class="row">
          <div class="col-sm">
            Monday
          </div>
          <div class="col-sm">
            Tuesday
          </div>
          <div class="col-sm">
            Wednesday
          </div>
          <div class="col-sm">
            Thursday
          </div>
          <div class="col-sm">
            Friday
          </div>
          <div class="col-sm">
            Saturday
          </div>
          <div class="col-sm">
            Sunday
          </div>
        </div>
        <div class="row">
          <div class="col-sm">
            🌡 30°C
          </div>
          <div class="col-sm">
            🌬 19°C
          </div>
          <div class="col-sm">
            ❄ 1°C
          </div>
          <div class="col-sm">
            ☃ 6°C
          </div>
          <div class="col-sm">
            ☔ 20°C
          </div>
          <div class="col-sm">
            ⛱ 29°C
          </div>
          <div class="col-sm">
            🌈 23°C
          </div>
        </div>
      </div>
    </div>
    <script>
      let h3 = document.querySelector("h3.date-display");

      let now = new Date();
      console.log(now);

      let days = [
        "Sunday",
        "Monday",
        "Tuesday",
        "Wednesday",
        "Thursday",
        "Friday",
        "Saturday"
      ];
      let today = days[now.getDay()];
      console.log(today);

      let hours = now.getHours();
      if (hours < 10) {
        hours = `0${hours}`;
      }
      let minutes = now.getMinutes();
      if (minutes < 10) {
        minutes = `0${minutes}`;
      }

      h3.innerHTML = `${today} ${hours}:${minutes}`;

      function displayWeatherCondition(response) {
        document.querySelector("#city").innerHTML = response.data.name;
        document.querySelector("#temperature").innerHTML = Math.round(
          response.data.main.temp
        );
        document.querySelector("#humidity").innerHTML =
          response.data.main.humidity;
        document.querySelector("#wind").innerHTML = Math.round(
          response.data.wind.speed
        );
        document.querySelector("#description").innerHTML =
          response.data.weather[0].main;
      }

      function searchCity(city) {
        let apiKey = "f45e74d7c2b9da42eac08c872edb3d3d";
        let apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`;
        axios.get(apiUrl).then(displayWeatherCondition);
      }

      function handleSubmit(event) {
        event.preventDefault();
        let city = document.querySelector("#city-input").value;
        searchCity(city);
      }

      function searchLocation(position) {
        let apiKey = "f45e74d7c2b9da42eac08c872edb3d3d";
        let apiUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${position.coords.latitude}&lon=${position.coords.longitude}&appid=${apiKey}&units=metric`;
        position.coords.latitude;
        position.coords.longitude;
        axios.get(apiUrl).then(displayWeatherCondition);
      }

      function getCurrentLocation(event) {
        event.preventDefault();
        navigator.geolocation.getCurrentPosition(searchLocation);
      }

      let searchform = document.querySelector("#search-form");
      searchform.addEventListener("submit", handleSubmit);

      let currentLocationButton = document.querySelector("#current-location");
      currentLocationButton.addEventListener("click", getCurrentLocation);

      searchCity("New York");
    </script>
  </body>
</html>
